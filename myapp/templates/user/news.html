{# templates/user/news.html #}
{% extends 'base.html' %} {# –¢–≤–æ–π –±–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —á–∞—Å—Ç–∏ #}

{% block title %}–ù–æ–≤–æ—Å—Ç–∏ –∏ –ê–∫—Ü–∏–∏{% endblock %}

{# –ë–ª–æ–∫ head –æ—Å—Ç–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–º, —Å—Ç–∏–ª–∏ –±—É–¥—É—Ç –≤ SCSS #}
{% block head %}{% endblock %}

{% block content %}
{# –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è —Å–µ–∫—Ü–∏–∏, —á—Ç–æ–±—ã —Å—Ç–∏–ª–∏ –ø—Ä–∏–º–µ–Ω—è–ª–∏—Å—å #}
<section class="news-list-section">
    <div class="content">
        <h1>–ù–æ–≤–æ—Å—Ç–∏ –∏ –ê–∫—Ü–∏–∏</h1>

        {# –í—ã–≤–æ–¥ flash-—Å–æ–æ–±—â–µ–Ω–∏–π #}
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <ul class="flashes">
                    {% for category, message in messages %}
                        <li class="{{ category }}">{{ message }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}

        {% if news_items %}
        <div class="news-grid">
            {% for item in news_items %}
            <div class="news-card">
                {# --- –ù–û–í–´–ô –ë–õ–û–ö –ë–ê–ù–ù–ï–†–ê --- #}
                {# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–Ω–Ω–µ—Ä, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å, –∏–Ω–∞—á–µ –±–ª–æ–∫ –∏–∫–æ–Ω–∫–∏ #}
                {% if item.banner_image %}
                <div class="news-card-banner">
                    <a href="{{ url_for('user.user_news_detail', news_id=item.id) }}">
                        {# –§–æ—Ä–º–∏—Ä—É–µ–º –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –≤ –ø–∞–ø–∫–µ –Ω–æ–≤–æ—Å—Ç–∏ #}
                        <img src="{{ url_for('static', filename='uploads/news_content/' + item.id|string + '/' + item.banner_image) }}" alt="{{ item.title }}">
                    </a>
                </div>
                {% else %}
                {# –û—Å—Ç–∞–≤–ª—è–µ–º –±–ª–æ–∫ –∏–∫–æ–Ω–∫–∏, –µ—Å–ª–∏ –±–∞–Ω–Ω–µ—Ä–∞ –Ω–µ—Ç #}
                <div class="news-card-icon">
                     <a href="{{ url_for('user.user_news_detail', news_id=item.id) }}"> {# –ò–∫–æ–Ω–∫—É —Ç–æ–∂–µ –¥–µ–ª–∞–µ–º —Å—Å—ã–ª–∫–æ–π #}
                        {% if item.icon %}
                            <img src="{{ url_for('static', filename='uploads/category_icons/' + item.icon) }}" alt="–ò–∫–æ–Ω–∫–∞">
                        {% else %}
                            <span class="no-icon">üì∞</span>
                        {% endif %}
                     </a>
                </div>
                {% endif %}
                {# --- –ö–û–ù–ï–¶ –ë–õ–û–ö–ê –ë–ê–ù–ù–ï–†–ê/–ò–ö–û–ù–ö–ò --- #}

                <div class="news-card-content">
                    <div class="news-card-type">
                        {% if item.type == 'news' %}
                            <span class="badge badge-info">–ù–æ–≤–æ—Å—Ç—å</span>
                        {% elif item.type == 'promo' %}
                            <span class="badge badge-success">–ê–∫—Ü–∏—è</span>
                        {% endif %}
                    </div>
                    <div class="news-card-title">
                         {# –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–µ–ª–∞–µ–º —Å—Å—ã–ª–∫–æ–π #}
                        <h3><a href="{{ url_for('user.user_news_detail', news_id=item.id) }}">{{ item.title }}</a></h3>
                    </div>
                    <div class="news-card-description">
                        {# –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ #}
                        <p>{{ item.short_description | default('–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è.', true) }}</p>
                    </div>
                    <div class="news-card-footer">
                        <span class="news-card-date">
                            {{ item.published_at.strftime('%d.%m.%Y') if item.published_at else item.created_at.strftime('%d.%m.%Y') }}
                        </span>
                        <span class="news-card-more">
                            {# –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥—Ä–æ–±–Ω–µ–µ" —Ç–µ–ø–µ—Ä—å –Ω–µ —Ç–∞–∫ –≤–∞–∂–Ω–∞, —Ç.–∫. –µ—Å—Ç—å —Å—Å—ã–ª–∫–∏ –≤—ã—à–µ #}
                            {# –ù–æ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è —è–≤–Ω–æ–≥–æ –ø—Ä–∏–∑—ã–≤–∞ –∫ –¥–µ–π—Å—Ç–≤–∏—é #}
                            <a href="{{ url_for('user.user_news_detail', news_id=item.id) }}">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                        </span>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p class="no-news-message">–°–µ–π—á–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –∏–ª–∏ –∞–∫—Ü–∏–π.</p>
        {% endif %}

    </div>{# –ö–æ–Ω–µ—Ü .content #}
</section>
{% endblock %}